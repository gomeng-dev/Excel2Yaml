# Excel → YAML 변환 후처리 설정 가이드

이 가이드는 Excel에서 YAML 파일로 변환 후 적용할 수 있는 두 가지 후처리 기능의 설정 방법을 설명합니다.

## 목차

1. [YAML 항목 병합 설정](#1-yaml-항목-병합-설정)
   - [기능 소개](#11-기능-소개)
   - [설정 입력 방법](#12-설정-입력-방법)
   - [설정 예시](#13-설정-예시)
   - [추가 옵션](#14-추가-옵션)

2. [YAML 항목 표시 형식 설정](#2-yaml-항목-표시-형식-설정)
   - [기능 소개](#21-기능-소개)
   - [설정 입력 방법](#22-설정-입력-방법)
   - [설정 예시](#23-설정-예시)

---

## 1. YAML 항목 병합 설정

### 1.1 기능 소개

YAML 항목 병합 기능을 사용하면 동일한 식별자(ID)를 가진 항목들을 자동으로 하나로 합칠 수 있습니다. 이 기능은 다음과 같은 상황에서 유용합니다:

- 같은 ID를 가진 항목을 하나로 통합하고 싶을 때
- 특정 항목의 배열이나 목록을 합치고 싶을 때
- 중복 내용을 정리하고 싶을 때

### 1.2 설정 입력 방법

시트 설정 화면의 **'병합 키 경로'** 입력란에 다음 형식으로 값을 입력합니다:

```
식별자경로|병합경로|병합방식설정|배열병합방식
```

각 설정값의 의미는 다음과 같습니다:

1. **식별자경로**: 항목을 구분하는 고유 ID가 있는 위치
   - 예: `id` 또는 `item.code`
   - 같은 식별자 값을 가진 항목들이 하나로 합쳐집니다

2. **병합경로**: 합치고 싶은 데이터 위치들
   - 쉼표(`,`) 또는 세미콜론(`;`)으로 구분
   - 예: `items,stats` 또는 `items;properties`

3. **병합방식설정**: 특별한 병합 방식이 필요한 항목들
   - 형식: `항목:방식`
   - 방식 종류: `match`, `merge`, `append`, `replace`, `skip`
   - 쉼표나 세미콜론으로 구분
   - 예: `level:merge,points:replace`

4. **배열병합방식**: 목록(배열) 항목의 병합 방식
   - 형식: `항목:방식`
   - 예: `skills:append,inventory:replace`

> **참고**: 구분 기호로 파이프(`|`)를 사용합니다. 사용하지 않는 설정이 있어도 파이프는 그대로 유지하세요.

### 1.3 설정 예시

#### 예시 1: 기본 ID 기반 병합

**설정값:**
```
id|items
```

**설정 의미:**
- `id` 항목이 같은 내용들을 하나로 합침
- `items` 목록의 내용을 합침

**실행 전:**
```yaml
- id: 1
  name: 아이템1
  items:
    - type: 무기
- id: 1
  items:
    - type: 방어구
```

**실행 후:**
```yaml
- id: 1
  name: 아이템1
  items:
    - type: 무기
    - type: 방어구
```

#### 예시 2: 여러 항목 병합 설정

**설정값:**
```
id|items,stats|level:merge;points:replace|results:append
```

**설정 의미:**
- `id`가 같은 항목들을 하나로 합침
- `items`와 `stats` 항목들을 합침
- `level` 항목은 병합 방식으로 합침
- `points` 항목은 새 값으로 교체
- `results` 목록은 항목 추가 방식으로 합침

**실행 전:**
```yaml
- id: 1
  name: 플레이어1
  level: 5
  points: 100
  results:
    - score: 80
- id: 1
  level: 6
  points: 200
  results:
    - score: 90
```

**실행 후:**
```yaml
- id: 1
  name: 플레이어1
  level: 6
  points: 200
  results:
    - score: 80
    - score: 90
```

### 1.4 추가 옵션

#### 병합 방식 종류

1. **일치 방식**(기본값): 일치하는 값만 병합
2. **병합 방식**: 항목 내용을 자세히 비교하여 병합
3. **추가 방식**: 목록에 항목을 추가
4. **교체 방식**: 기존 값을 새 값으로 덮어씀
5. **건너뛰기 방식**: 해당 항목 병합 안 함

#### 빈 항목 유지 설정

시트 설정 화면의 **'YAML 빈 필드 포함'** 항목을 '예'로 설정하면 비어있는 항목(null 값이나 빈 목록)도 YAML 파일에 포함됩니다.

---

## 2. YAML 항목 표시 형식 설정

### 2.1 기능 소개

YAML 항목 표시 형식 설정을 사용하면 특정 항목들을 한 줄로 간결하게 표시할 수 있습니다. 이 기능은 다음과 같은 경우에 유용합니다:

- YAML 파일을 더 읽기 쉽게 정리하고 싶을 때
- 짧은 목록이나 항목을 간결하게 표시하고 싶을 때
- 특정 구조에 일관된 표시 스타일을 적용하고 싶을 때

### 2.2 설정 입력 방법

시트 설정 화면의 **'흐름 스타일'** 입력란에 다음 형식으로 값을 입력합니다:

```
한줄표시항목|목록내항목표시
```

각 설정값의 의미는 다음과 같습니다:

1. **한줄표시항목**: 한 줄로 표시할 항목 이름들
   - 쉼표로 구분
   - 예: `stats,coordinates,options`

2. **목록내항목표시**: 목록 내 각 항목을 한 줄로 표시할 항목 이름들
   - 쉼표로 구분
   - 예: `abilities,skills,items`

> **참고**: 
> - 첫 번째 설정은 해당 항목 자체를 한 줄로 표시합니다.
> - 두 번째 설정은 목록 내 각 항목을 한 줄로 표시합니다.
> - 사용하지 않는 설정이 있어도 파이프(`|`)는 유지하세요.

### 2.3 설정 예시

#### 예시 1: 항목을 한 줄로 표시

**설정값:**
```
stats,position|
```

**설정 의미:**
- `stats`와 `position` 항목을 한 줄로 표시

**실행 전:**
```yaml
character:
  name: 플레이어
  stats:
    strength: 10
    dexterity: 8
    intelligence: 12
  position:
    x: 100
    y: 200
```

**실행 후:**
```yaml
character:
  name: 플레이어
  stats: { strength: 10, dexterity: 8, intelligence: 12 }
  position: { x: 100, y: 200 }
```

#### 예시 2: 목록 내 항목을 한 줄로 표시

**설정값:**
```
|abilities,inventory
```

**설정 의미:**
- `abilities`와 `inventory` 목록의 각 항목을 한 줄로 표시

**실행 전:**
```yaml
character:
  name: 플레이어
  abilities:
    - name: 화염구
      damage: 50
      mana: 30
    - name: 회복
      healing: 40
      mana: 20
  inventory:
    - id: 101
      name: 검
      level: 5
    - id: 102
      name: 방패
      level: 3
```

**실행 후:**
```yaml
character:
  name: 플레이어
  abilities:
    - { name: 화염구, damage: 50, mana: 30 }
    - { name: 회복, healing: 40, mana: 20 }
  inventory:
    - { id: 101, name: 검, level: 5 }
    - { id: 102, name: 방패, level: 3 }
```

---

## 두 설정 함께 사용하기

Excel에서는 두 후처리 설정을 순서대로 적용합니다:

1. 먼저 병합 설정 적용
2. 다음으로 표시 형식 설정 적용

따라서 두 설정을 모두 입력하면 병합된 결과에 표시 형식이 적용됩니다.

### 예시: 두 설정 함께 사용하기

**병합 설정:**
```
id|items,stats|level:merge|skills:append
```

**표시 형식 설정:**
```
stats,position|skills
```

**결과:**
1. 먼저 `id`를 기준으로 항목을 병합
2. 그 다음 `stats`와 `position` 항목을 한 줄로 표시
3. `skills` 목록의 각 항목을 한 줄로 표시

---

## 주의사항

1. 병합 작업 시 나중에 나오는 값이 이전 값을 덮어씁니다.
2. 표시 형식 설정은 데이터 내용을 변경하지 않고 표시 방식만 바꿉니다.
3. 복잡한 구조에서는 정확한 항목 이름 지정이 중요합니다.
4. 두 설정 모두 Excel 시트 설정 화면의 해당 시트 행에 입력해야 합니다.
5. 설정을 변경한 후에는 반드시 다시 YAML로 변환해야 설정이 적용됩니다.

---

## 문제 해결

- **병합이 제대로 되지 않음**: 식별자 항목 이름이 정확한지, 병합 항목 이름이 올바른지 확인하세요.
- **표시 형식이 적용되지 않음**: 항목 이름이 정확히 일치하는지 확인하세요.
- **오류 메시지**: 설정 값 형식과 구분자(|, ;, ,)가 올바른지 확인하세요.

추가 도움이 필요하면 개발팀에 문의하세요. 